function [  ] = display_results(filename)
% This function plots results generated by fit_nuna_model
%% Angel Rodes, 2021

%example: plot_results('NEG_samples_bedrock')

%% load data
load(filename)

% Load version data
mucont=muon_contribution(0,0,10);

% Credits
disp(' ')
disp('-----------------------------------------------')
disp('NUNAtak Ice-Thinning calculator')
disp('Angel Rodes, 2021')
% disp('www.angelrodes.com')
disp(['Version: ' consts.ver])
disp(['Muon contributions: ' mucont.ver])
disp(['Fitting method: ' fitter.ver])
disp('-----------------------------------------------')
disp(['Dataset: ' samples.filename])
disp(['Climate data: ' climatecurves.ver])
display_sample_data(samples)
disp('-----------------------------------------------')
disp('Fitting results:')
disp(['Models tested: ' num2str(sum(~isnan(CHISQ)))])
disp(['Min. Chi-square: ' num2str(minchi)])
disp(['Red. Chi-square: ' num2str(minchi/results.DOF)])
disp(['DOF: ' num2str(results.DOF)])
disp(['One-sigma models: ' num2str(results.nmodels_onesigma)])
if results.nmodels_onesigma<100
    disp(['Only ' num2str(results.nmodels_onesigma) ' models fitting the data!!! Try increasing consts.maxnmodels...'])
end
disp(' ')
disp(['Parameters and one sigma range:'])
disp(['Ice-thinning since glacial maximum: ' num2str(round(results.ic(2))) ' [ ' num2str(round(results.ic(1))) ' - ' num2str(round(results.ic(3))) ' ] m'])
disp(['Weathering: ' num2str(results.W(2)*1e4,4) ' [ ' num2str(results.W(1)*1e4,4) ' - ' num2str(results.W(3)*1e4,4) ' ] mm/ka'])
disp(['Glacial erosion: ' num2str(results.E(2)*1e4/1e3,4) ' [ ' num2str(results.E(1)*1e4/1e3,4) ' - ' num2str(results.E(3)*1e4/1e3,4) ' ] mm/a'])
disp(['Uplift rate: ' num2str(results.UR(2),4) ' [ ' num2str(results.UR(1),4) ' - ' num2str(results.UR(3),4) ' ] m/Ma'])
disp(['Deviation of current ice level: ' num2str(round(results.DELTAH(2))) ' [ ' num2str(round(results.DELTAH(1))) ' - ' num2str(round(results.DELTAH(3))) ' ] m'])
% disp('-----------------------------------------------')
disp(' ')
end % end function

