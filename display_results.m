function [  ] = display_results(filename)
% This function plots results generated by fit_nuna_model
%% Angel Rodes, 2021

%% load data
load(filename)

% Load version data
mucont=muon_contribution(0,0,10);

% Credits
disp(' ')
disp('-----------------------------------------------')
disp('NUNAtak Ice-Thinning calculator')
disp('Angel Rodes, 2021')
% disp('www.angelrodes.com')
disp(['Version: '  char(9) consts.ver])
disp(['Muon contributions: ' char(9) mucont.ver])
disp(['Fitting method: '  char(9) fitter.ver])
disp('-----------------------------------------------')
disp(['Dataset: '  char(9) samples.filename])
disp(['Climate data: '  char(9) climatecurves.ver])
disp(['Fit type: '  char(9) num2str(consts.minimum_ages)])
display_sample_data(samples)
disp('-----------------------------------------------')
disp('Fitting results:')
disp(['Models tested: '  char(9) num2str(sum(~isnan(CHISQ)))])
disp(['Min. Chi-square: '  char(9) num2str(minchi)])
disp(['Red. Chi-square: '  char(9) num2str(minchi/results.DOF)])
disp(['DOF: '  char(9) num2str(results.DOF)])
disp(['One-sigma models: '  char(9) num2str(results.nmodels_onesigma)])
if results.nmodels_onesigma<100
    disp(['Only ' num2str(results.nmodels_onesigma) ' models fitting the data!!! Try increasing consts.maxnmodels...'])
end
disp(' ')
disp(['Parameters: {tested range} best [one sigma range]'])
disp(['Ice-thinning since glacial maximum: ' '{' char(9) num2str(round(min(ic)))  char(9) '-'  char(9)  num2str(round(max(ic))) '}'  char(9)...
    num2str(round(results.ic(2))) char(9)...
    '['  char(9)  num2str(round(results.ic(1))) char(9) '-'  char(9) num2str(round(results.ic(3))) char(9) ']' char(9)...
    'm'])
disp(['Weathering: '  '{' char(9) num2str(min(W)*1e4,4) char(9) '-'  char(9) num2str(max(W)*1e4,4) '}'  char(9)...
    num2str(results.W(2)*1e4,4)  char(9)...
    '['  char(9) num2str(results.W(1)*1e4,4) char(9) '-'  char(9) num2str(results.W(3)*1e4,4) ']' char(9)...
    'mm/ka'])
disp(['Glacial erosion: '  '{' char(9) num2str(min(E)*1e4,4) char(9) '-'  char(9) num2str(max(E)*1e4,4) '}'  char(9)...
    num2str(results.E(2)*1e4,4) char(9)...
    '['  char(9) num2str(results.E(1)*1e4,4) char(9) '-'  char(9) num2str(results.E(3)*1e4,4) ']' char(9)...
    'mm/ka'])
disp(['Uplift rate: ' '{' char(9) num2str(min(UR),4) char(9) '-'  char(9) num2str(max(UR),4) '}'  char(9)...
    num2str(results.UR(2),4) char(9)...
     '['  char(9) num2str(results.UR(1),4) char(9) '-'  char(9) num2str(results.UR(3),4) ']' char(9)...
     'm/Ma'])
disp(['Deviation of current ice level: ' '{' char(9) num2str(round(min(DELTAH))) char(9) '-'  char(9) num2str(round(max(DELTAH))) '}'  char(9)...
    num2str(round(results.DELTAH(2))) char(9)...
    '['  char(9) num2str(round(results.DELTAH(1))) char(9) '-'  char(9) num2str(round(results.DELTAH(3))) ']' char(9)...
    'm'])
% disp('-----------------------------------------------')               
disp(' ')
end % end function

